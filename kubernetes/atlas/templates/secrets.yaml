{{- if not .Values.secrets.existingSecret -}}
{{- $fullName := include "atlas.fullname" . -}}
apiVersion: v1
kind: Secret
metadata:
  name: {{ $fullName }}-secrets
  labels:
    {{- include "atlas.labels" . | nindent 4 }}
type: Opaque
stringData:
  # Atlas Core
  {{- if .Values.secrets.atlasSecretKey }}
  ATLAS_SECRET_KEY: {{ .Values.secrets.atlasSecretKey | quote }}
  {{- end }}
  {{- if .Values.secrets.atlasUiSecret }}
  ATLAS_UI_SECRET: {{ .Values.secrets.atlasUiSecret | quote }}
  {{- end }}
  {{- if .Values.secrets.atlasApiToken }}
  ATLAS_API_TOKEN: {{ .Values.secrets.atlasApiToken | quote }}
  {{- end }}
  {{- if .Values.secrets.atlasDefaultAdminUsername }}
  ATLAS_DEFAULT_ADMIN_USERNAME: {{ .Values.secrets.atlasDefaultAdminUsername | quote }}
  {{- end }}
  {{- if .Values.secrets.atlasDefaultAdminPassword }}
  ATLAS_DEFAULT_ADMIN_PASSWORD: {{ .Values.secrets.atlasDefaultAdminPassword | quote }}
  {{- end }}
  
  # NetBox
  {{- if .Values.secrets.netboxUrl }}
  NETBOX_URL: {{ .Values.secrets.netboxUrl | quote }}
  {{- end }}
  {{- if .Values.secrets.netboxToken }}
  NETBOX_TOKEN: {{ .Values.secrets.netboxToken | quote }}
  {{- end }}
  
  # Atlassian
  {{- if .Values.secrets.atlassianBaseUrl }}
  ATLASSIAN_BASE_URL: {{ .Values.secrets.atlassianBaseUrl | quote }}
  ATLAS_RAG_CONFLUENCE_BASE_URL: {{ .Values.secrets.atlassianBaseUrl | quote }}
  {{- end }}
  {{- if .Values.secrets.atlassianEmail }}
  ATLASSIAN_EMAIL: {{ .Values.secrets.atlassianEmail | quote }}
  ATLAS_RAG_CONFLUENCE_USERNAME: {{ .Values.secrets.atlassianEmail | quote }}
  {{- end }}
  {{- if .Values.secrets.atlassianApiToken }}
  ATLASSIAN_API_TOKEN: {{ .Values.secrets.atlassianApiToken | quote }}
  ATLAS_RAG_CONFLUENCE_API_TOKEN: {{ .Values.secrets.atlassianApiToken | quote }}
  {{- end }}
  {{- if .Values.secrets.confluenceCmdbPageId }}
  CONFLUENCE_CMDB_PAGE_ID: {{ .Values.secrets.confluenceCmdbPageId | quote }}
  {{- end }}
  
  # Zabbix
  {{- if .Values.secrets.zabbixApiUrl }}
  ZABBIX_API_URL: {{ .Values.secrets.zabbixApiUrl | quote }}
  {{- end }}
  {{- if .Values.secrets.zabbixWebUrl }}
  ZABBIX_WEB_URL: {{ .Values.secrets.zabbixWebUrl | quote }}
  ZABBIX_HOST: {{ .Values.secrets.zabbixWebUrl | quote }}
  {{- end }}
  {{- if .Values.secrets.zabbixApiToken }}
  ZABBIX_API_TOKEN: {{ .Values.secrets.zabbixApiToken | quote }}
  {{- end }}
  
  # vCenter (credentials stored in DB via secret store, not env vars)
  # vCenter configs are managed through the web UI

  # Commvault
  {{- if .Values.secrets.commvaultBaseUrl }}
  COMMVAULT_BASE_URL: {{ .Values.secrets.commvaultBaseUrl | quote }}
  {{- end }}
  {{- if .Values.secrets.commvaultApiToken }}
  COMMVAULT_API_TOKEN: {{ .Values.secrets.commvaultApiToken | quote }}
  {{- end }}
  
  # AI/RAG
  {{- if .Values.secrets.googleApiKey }}
  GOOGLE_API_KEY: {{ .Values.secrets.googleApiKey | quote }}
  {{- end }}
  {{- if .Values.secrets.anthropicApiKey }}
  ANTHROPIC_API_KEY: {{ .Values.secrets.anthropicApiKey | quote }}
  {{- end }}
  
  # Slack
  {{- if .Values.secrets.slackBotToken }}
  SLACK_BOT_TOKEN: {{ .Values.secrets.slackBotToken | quote }}
  {{- end }}
  {{- if .Values.secrets.slackAppToken }}
  SLACK_APP_TOKEN: {{ .Values.secrets.slackAppToken | quote }}
  {{- end }}
  
  # Telegram
  {{- if .Values.secrets.telegramBotToken }}
  TELEGRAM_BOT_TOKEN: {{ .Values.secrets.telegramBotToken | quote }}
  {{- end }}
{{- end }}
